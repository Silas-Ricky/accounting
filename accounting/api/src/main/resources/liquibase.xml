<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9
                  http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd">

	<!-- See http://www.liquibase.org/manual/home#available_database_refactorings 
		for a list of supported elements and attributes -->


	<changeSet author="viet" id="201405120219">

		<createTable tableName="accounting_account">
			<column autoIncrement="true" name="id" type="int">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="name" type="varchar(255)">
				<constraints nullable="false" />
			</column>
			<column name="description" type="varchar(500)" />
			<column name="retired_date" type="DATETIME" />
			<column name="retired_by" type="int" />
			<column name="retired" defaultValueBoolean="false" type="BOOLEAN">
				<constraints nullable="false" />
			</column>
			<column name="updated_date" type="DATETIME" />
			<column name="created_date" type="DATETIME">
				<constraints nullable="false" />
			</column>
			<column name="created_by" defaultValueNumeric="0" type="int">
				<constraints nullable="false" />
			</column>
			<column name="updated_by" type="int" />
			<column name="parrent_account_id" type="int" />
			<column name="account_type" type="varchar(50)">
				<constraints nullable="false" />
			</column>


		</createTable>


		<createTable tableName="accounting_account_fiscal_period">
			<column autoIncrement="true" name="id" type="int">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="account_id" type="int">
				<constraints nullable="false" />
			</column>
			<column name="fiscal_period_id" type="int">
				<constraints nullable="false" />
			</column>

			<column name="start_date" type="DATETIME"></column>
			<column name="end_date" type="DATETIME"></column>
			<column name="updated_date" type="DATETIME" />
			<column name="created_date" type="DATETIME">
				<constraints nullable="false" />
			</column>
			<column name="created_by" type="int">
				<constraints nullable="false" />
			</column>
			<column name="updated_by" type="int" />

			<column name="opening_balance" type="currency" />
			<column name="closing_balance" type="currency" />
			<column name="ledger_balance" type="currency" />
			<column name="available_balance" type="currency" />
			<column name="status" type="varchar(10)" />
		</createTable>

		<createTable tableName="accounting_fiscal_period">
			<column autoIncrement="true" name="id" type="int">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="fiscal_year_id" type="int">
				<constraints nullable="false" />
			</column>
			<column name="name" type="varchar(255)">
				<constraints nullable="false" />
			</column>
			<column name="start_date" type="DATETIME"></column>
			<column name="end_date" type="DATETIME"></column>
			<column name="updated_date" type="DATETIME" />
			<column name="created_date" type="DATETIME">
				<constraints nullable="false" />
			</column>
			<column name="created_by" defaultValueNumeric="0" type="int">
				<constraints nullable="false" />
			</column>
			<column name="updated_by" type="int" />
			<column name="status" type="varchar(10)" />
		</createTable>

		<createTable tableName="accounting_fiscal_year">
			<column autoIncrement="true" name="id" type="int">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="name" type="varchar(255)">
				<constraints nullable="false" />
			</column>
			<column name="start_date" type="DATETIME" />
			<column name="end_date" type="DATETIME" />
			<column name="updated_date" type="DATETIME" />
			<column name="created_date" type="DATETIME">
				<constraints nullable="false" />
			</column>
			<column name="created_by" defaultValueNumeric="0" type="int">
				<constraints nullable="false" />
			</column>
			<column name="updated_by" type="int" />
			<column name="status" type="varchar(10)" />
			<column name="opening_balance" type="currency" />
			<column name="closing_balance" type="currency" />
		</createTable>
	</changeSet>

	<changeSet author="viet" id="201405230534">
		<createTable tableName="accounting_income_receipt">
			<column autoIncrement="true" name="id" type="int">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="receipt_no" type="varchar(255)" />
			<column name="description" type="varchar(1000)" />

			<column name="voided" defaultValueBoolean="false" type="BOOLEAN">
				<constraints nullable="false" />
			</column>
			<column name="voided_date" type="DATETIME">
				<constraints nullable="false" />
			</column>
			<column name="voided_by" defaultValueNumeric="0" type="int">
				<constraints nullable="false" />
			</column>
			<column name="receipt_date" type="DATETIME">
				<constraints nullable="false" />
			</column>
			<column name="created_date" type="DATETIME">
				<constraints nullable="false" />
			</column>
			<column name="created_by" defaultValueNumeric="0" type="int">
				<constraints nullable="false" />
			</column>
		</createTable>

		<createTable tableName="accounting_income_receipt_item">
			<column autoIncrement="true" name="id" type="int">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="description" type="varchar(1000)" />
			<column name="account_id" type="int">
				<constraints nullable="false" />
			</column>
			<column name="income_receipt_id" type="int">
				<constraints nullable="false" />
			</column>
			<column name="amount" type="currency" />
			<column name="cheque_number" type="varchar(255)" />
			<column name="type" type="varchar(20)" />
			<column name="transaction_date" type="DATETIME">
				<constraints nullable="false" />
			</column>
			<column name="created_date" type="DATETIME">
				<constraints nullable="false" />
			</column>
			<column name="created_by" defaultValueNumeric="0" type="int">
				<constraints nullable="false" />
			</column>
			<column name="voided" defaultValueBoolean="false" type="BOOLEAN">
				<constraints nullable="false" />
			</column>
			<column name="voided_date" type="DATETIME">
				<constraints nullable="false" />
			</column>
			<column name="voided_by" defaultValueNumeric="0" type="int">
				<constraints nullable="false" />
			</column>
		</createTable>

		<addForeignKeyConstraint constraintName="accounting_income_receipt_item_receipt_fk"
			baseTableName="accounting_income_receipt_item" baseColumnNames="income_receipt_id"
			referencedTableName="accounting_income_receipt"
			referencedColumnNames="id" />
		<addForeignKeyConstraint constraintName="accounting_income_receipt_item_account_fk"
			baseTableName="accounting_income_receipt_item" baseColumnNames="account_id"
			referencedTableName="accounting_account" referencedColumnNames="id" />

	</changeSet>

	<changeSet author="viet" id="201405120341">

		<addForeignKeyConstraint constraintName="accounting_account_period_account_fk"
			baseTableName="accounting_account_fiscal_period" baseColumnNames="account_id"
			referencedTableName="accounting_account" referencedColumnNames="id" />
		<addForeignKeyConstraint constraintName="accounting_account_period_fiscal_period_fk"
			baseTableName="accounting_account_fiscal_period" baseColumnNames="fiscal_period_id"
			referencedTableName="accounting_fiscal_period" referencedColumnNames="id" />
		<addForeignKeyConstraint constraintName="accounting_fiscal_period_fiscal_year_fk"
			baseTableName="accounting_fiscal_period" baseColumnNames="fiscal_year_id"
			referencedTableName="accounting_fiscal_year" referencedColumnNames="id" />
	</changeSet>

	<changeSet author="viet" id="201405250234">
		<addColumn tableName="accounting_income_receipt">
			<column name="updated_date" type="DATETIME" />
		</addColumn>
		<addColumn tableName="accounting_income_receipt">
			<column name="updated_by" type="int" />
		</addColumn>
		<addColumn tableName="accounting_income_receipt_item">
			<column name="updated_date" type="DATETIME" />
		</addColumn>
		<addColumn tableName="accounting_income_receipt_item">
			<column name="updated_by" type="int" />
		</addColumn>
	</changeSet>
	

	<changeSet author="viet" id="2014050304">
		<dropNotNullConstraint columnDataType="DATETIME"
			columnName="voided_date" tableName="accounting_income_receipt" />

		<dropNotNullConstraint columnDataType="DATETIME"
			columnName="voided_date" tableName="accounting_income_receipt_item" />

		<dropNotNullConstraint columnDataType="int"
			columnName="voided_by" tableName="accounting_income_receipt_item" />

		<dropNotNullConstraint columnDataType="int"
			columnName="voided_by" tableName="accounting_income_receipt" />
	</changeSet>


	<changeSet author="viet" id="2014050305">
		<dropNotNullConstraint columnDataType="DATETIME"
			columnName="created_date" tableName="accounting_account" />
	</changeSet>
	<changeSet author="viet" id="2014050306">
		<dropNotNullConstraint columnDataType="DATETIME"
			columnName="transaction_date" tableName="accounting_income_receipt_item" />
	</changeSet>





	<changeSet author="viet" id="201405250236">
		<addColumn tableName="accounting_income_receipt">
			<column name="status" type="varchar(50)" />
		</addColumn>
	</changeSet>

	<changeSet author="viet" id="201405250239">
		<createTable tableName="accounting_account_txn">
			<column autoIncrement="true" name="account_txn_id" type="int">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="account_id" type="int">
				<constraints nullable="false" />
			</column>
			<column name="balance" type="currency" />
			<column name="credit" type="currency" />
			<column name="debit" type="currency" />
			<column name="txn_type" type="varchar(20)" />
			<column name="txn_date" type="DATETIME" />
			<column name="created_date" type="DATETIME" />
			<column name="created_by" defaultValueNumeric="0" type="int" />
			<column name="updated_date" type="DATETIME" />
			<column name="updated_by" defaultValueNumeric="0" type="int" />
			<column name="txn_number" type="varchar(50)" />
			<column name="base_txn_number" type="varchar(50)" />
			<column name="reference_txn" type="varchar(50)" />
			<column name="cancel_for_txn" type="varchar(50)" />
			<column name="txn_status" type="varchar(10)" />
		</createTable>
	</changeSet>

	<changeSet author="viet" id="2014060601345">
		<renameTable newTableName="accounting_account_balance"
			oldTableName="accounting_account_fiscal_period" />
	</changeSet>
	<changeSet author="viet" id="201406071216">
		<dropNotNullConstraint columnDataType="DATETIME"
			columnName="fiscal_period_id" tableName="accounting_account_balance" />
	</changeSet>

	<changeSet author="viet" id="201406071254">
		<addColumn tableName="accounting_income_receipt_item">
			<column name="txn_number" type="varchar(50)" />
		</addColumn>
	</changeSet>
	
	<changeSet author="viet" id="201406111034">
		<addColumn tableName="accounting_account">
			<column name="concept_id" type="int" />
		</addColumn>
	</changeSet>
	
	<changeSet author="viet" id="201406130340">
		<createTable tableName="accounting_budget">
			<column autoIncrement="true" name="budget_id" type="int">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="name" type="varchar(255)"/>
			<column name="description" type="varchar(1000)"/>
			<column name="start_date" type="DATETIME"/>
			<column name="end_date" type="DATETIME"/>
			<column name="updated_date" type="DATETIME" />
			<column name="created_date" type="DATETIME">
				<constraints nullable="false" />
			</column>
			<column name="created_by" type="int">
				<constraints nullable="false" />
			</column>
			<column name="updated_by" type="int" />
				<column name="retired_date" type="DATETIME" />
			<column name="retired_by" type="int" />
			<column name="retired" defaultValueBoolean="false" type="BOOLEAN">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	
	<changeSet author="viet" id="201406120358">
		<createTable tableName="accounting_budget_item">
			<column autoIncrement="true" name="budget_item_id" type="int">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="account_id" type="int">
				<constraints nullable="false" />
			</column>
			
			<column name="budget_id" type="int">
				<constraints nullable="false" />
			</column>
			
			<column name="start_date" type="DATETIME"/>
			<column name="end_date" type="DATETIME"/>
			<column name="updated_date" type="DATETIME" />
			<column name="created_date" type="DATETIME">
				<constraints nullable="false" />
			</column>
			<column name="created_by" type="int">
				<constraints nullable="false" />
			</column>
			<column name="updated_by" type="int" />
			<column name="amount" type="decimal(9,2)" />
			<column name="retired_date" type="DATETIME" />
			<column name="retired_by" type="int" />
			<column name="retired" defaultValueBoolean="false" type="BOOLEAN">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	<changeSet author="viet" id="201406140354">
		<addColumn tableName="accounting_budget_item">
			<column name="description" type="varchar(1000)" />
		</addColumn>
	</changeSet>
	
	<changeSet author="viet" id="201406191238">
		<addColumn tableName="accounting_account_txn">
			<column name="amount" type="decimal(9,2)" />
		</addColumn>
	</changeSet>
	
	<changeSet author="viet" id="20140619858">
		<addColumn tableName="accounting_budget_item">
			<column name="txn_number" type="varchar(50)" />
		</addColumn>
	</changeSet>
	
	<changeSet author="viet" id="201406220305">
		<createTable tableName="accounting_payment">
			<column name="payment_id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column name="account_id" type="int"/>
			<column name="payee_id" type="int"/>
			<column name="ref_order_no" type="varchar(255)"/>
			<column name="commitment_no" type="int"/>
			<column name="voucher_no" type="varchar(255)"/>
			<column name="cost" type="decimal(9,2)"/>
			<column name="total_commitment" type="decimal(9,2)"/>
			<column name="payable" type="decimal(9,2)"/>
			<column name="total_payable" type="decimal(9,2)"/>
			<column name="actual_payment" type="decimal(9,2)"/>
			<column name="total_actual_payment" type="decimal(9,2)"/>
			<column name="total_payable_plus_payment" type="decimal(9,2)"/>
			<column name="payment_date" type="DATETIME"/>
			<column name="updated_date" type="DATETIME" />
			<column name="created_date" type="DATETIME">
				<constraints nullable="false" />
			</column>
			<column name="created_by" type="int">
				<constraints nullable="false" />
			</column>
			<column name="updated_by" type="int" />
			<column name="retired_by" type="int" />
			<column name="retired_date" type="DATETIME" />
			<column name="retired" defaultValueBoolean="false" type="BOOLEAN">
				<constraints nullable="false" />
			</column>
			<column name="status" type="varchar(50)"/>
			<column name="note" type="varchar(1000)"/>
		</createTable>
	</changeSet>
	
	<changeSet author="viet" id="201406281157">
		<addColumn tableName="accounting_payment">
			<column name="total_aie" type="decimal(9,2)" />
		</addColumn>
	</changeSet>
	
	<changeSet author="viet" id="201406220310">
		<createTable tableName="accounting_payee">
			<column name="payee_id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column name="name" type="varchar(255)"/>
			<column name="description" type="varchar(1000)"/>
			<column name="updated_date" type="DATETIME" />
			<column name="created_date" type="DATETIME">
				<constraints nullable="false" />
			</column>
			<column name="created_by" type="int">
				<constraints nullable="false" />
			</column>
			<column name="updated_by" type="int" />
			<column name="retired_by" type="int" />
			<column name="retired_date" type="DATETIME" />
			<column name="retired" defaultValueBoolean="false" type="BOOLEAN">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	
	
	<changeSet author="viet" id="201406280417">
		<createTable tableName="accounting_expense_balance">
			<column name="expense_balance_id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column name="account_id" type="int"/>
			<column name="fiscal_period_id" type="int"/>
			<column name="new_aie" type="decimal(9,2)"/>
			<column name="cummulative_aie" type="decimal(9,2)"/>
			<column name="current_payment" type="decimal(9,2)"/>
			<column name="cummulative_payment" type="decimal(9,2)"/>
			<column name="available_balance" type="decimal(9,2)"/>
			<column name="start_date" type="DATETIME"/>
			<column name="end_date" type="DATETIME"/>
			<column name="updated_date" type="DATETIME" />
			<column name="created_date" type="DATETIME">
				<constraints nullable="false" />
			</column>
			<column name="created_by" type="int">
				<constraints nullable="false" />
			</column>
			<column name="updated_by" type="int" />
			<column name="status" type="varchar(50)"/>
		</createTable>
	</changeSet>
</databaseChangeLog>